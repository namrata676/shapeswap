{"ast":null,"code":"import ifosList from'config/constants/ifo';import{campaignMap}from'config/constants/campaigns';import{multicallv2}from'utils/multicall';import{getPointCenterIfoAddress}from'utils/addressHelpers';import pointCenterIfoABI from'config/abi/pointCenterIfo.json';export const getAchievementTitle=campaign=>{switch(campaign.type){case'ifo':return{key:'IFO Shopper: %title%',data:{title:campaign.title}};default:return campaign.title;}};export const getAchievementDescription=campaign=>{switch(campaign.type){case'ifo':return{key:'Committed more than $5 worth of LP in the %title% IFO',data:{title:campaign.title}};default:return campaign.description;}};/**\n * Checks if a wallet is eligible to claim points from valid IFO's\n */export const getClaimableIfoData=async account=>{const ifoCampaigns=ifosList.filter(ifoItem=>ifoItem.campaignId!==undefined);// Returns the claim status of every IFO with a campaign ID\nconst claimStatusCalls=ifoCampaigns.map(_ref=>{let{address}=_ref;return{address:getPointCenterIfoAddress(),name:'checkClaimStatus',params:[account,address]};});const claimStatuses=await multicallv2(pointCenterIfoABI,claimStatusCalls,{requireSuccess:false});// Get IFO data for all IFO's that are eligible to claim\nconst claimableIfoData=await multicallv2(pointCenterIfoABI,claimStatuses.reduce((accum,claimStatusArr,index)=>{if(claimStatusArr===null){return accum;}const[claimStatus]=claimStatusArr;if(claimStatus===true){return[...accum,{address:getPointCenterIfoAddress(),name:'ifos',params:[index]}];}return accum;},[]));// Transform response to an Achievement\nreturn claimableIfoData.reduce((accum,claimableIfoDataItem)=>{if(!campaignMap.has(claimableIfoDataItem.campaignId)){return accum;}const campaignMeta=campaignMap.get(claimableIfoDataItem.campaignId);const{address}=ifoCampaigns.find(ifoCampaign=>ifoCampaign.campaignId===claimableIfoDataItem.campaignId);return[...accum,{address,id:claimableIfoDataItem.campaignId,type:'ifo',title:getAchievementTitle(campaignMeta),description:getAchievementDescription(campaignMeta),badge:campaignMeta.badge,points:claimableIfoDataItem.numberPoints.toNumber()}];},[]);};","map":{"version":3,"names":["ifosList","campaignMap","multicallv2","getPointCenterIfoAddress","pointCenterIfoABI","getAchievementTitle","campaign","type","key","data","title","getAchievementDescription","description","getClaimableIfoData","account","ifoCampaigns","filter","ifoItem","campaignId","undefined","claimStatusCalls","map","_ref","address","name","params","claimStatuses","requireSuccess","claimableIfoData","reduce","accum","claimStatusArr","index","claimStatus","claimableIfoDataItem","has","campaignMeta","get","find","ifoCampaign","id","badge","points","numberPoints","toNumber"],"sources":["/Users/namratapatel/upwork/SmartFinance-OmniDex/src/utils/achievements.ts"],"sourcesContent":["import { ethers } from 'ethers'\nimport { Campaign } from 'config/constants/types'\nimport ifosList from 'config/constants/ifo'\nimport { campaignMap } from 'config/constants/campaigns'\nimport { Achievement, TranslatableText } from 'state/types'\nimport { multicallv2 } from 'utils/multicall'\nimport { getPointCenterIfoAddress } from 'utils/addressHelpers'\nimport pointCenterIfoABI from 'config/abi/pointCenterIfo.json'\n\ninterface IfoMapResponse {\n  thresholdToClaim: string\n  campaignId: string\n  numberPoints: ethers.BigNumber\n}\n\nexport const getAchievementTitle = (campaign: Campaign): TranslatableText => {\n  switch (campaign.type) {\n    case 'ifo':\n      return {\n        key: 'IFO Shopper: %title%',\n        data: {\n          title: campaign.title as string,\n        },\n      }\n    default:\n      return campaign.title\n  }\n}\n\nexport const getAchievementDescription = (campaign: Campaign): TranslatableText => {\n  switch (campaign.type) {\n    case 'ifo':\n      return {\n        key: 'Committed more than $5 worth of LP in the %title% IFO',\n        data: {\n          title: campaign.title as string,\n        },\n      }\n    default:\n      return campaign.description\n  }\n}\n\n/**\n * Checks if a wallet is eligible to claim points from valid IFO's\n */\nexport const getClaimableIfoData = async (account: string): Promise<Achievement[]> => {\n  const ifoCampaigns = ifosList.filter((ifoItem) => ifoItem.campaignId !== undefined)\n\n  // Returns the claim status of every IFO with a campaign ID\n  const claimStatusCalls = ifoCampaigns.map(({ address }) => {\n    return {\n      address: getPointCenterIfoAddress(),\n      name: 'checkClaimStatus',\n      params: [account, address],\n    }\n  })\n\n  const claimStatuses = (await multicallv2(pointCenterIfoABI, claimStatusCalls, { requireSuccess: false })) as\n    | [boolean][]\n    | null\n\n  // Get IFO data for all IFO's that are eligible to claim\n  const claimableIfoData = (await multicallv2(\n    pointCenterIfoABI,\n    claimStatuses.reduce((accum, claimStatusArr, index) => {\n      if (claimStatusArr === null) {\n        return accum\n      }\n\n      const [claimStatus] = claimStatusArr\n\n      if (claimStatus === true) {\n        return [...accum, { address: getPointCenterIfoAddress(), name: 'ifos', params: [index] }]\n      }\n\n      return accum\n    }, []),\n  )) as IfoMapResponse[]\n\n  // Transform response to an Achievement\n  return claimableIfoData.reduce((accum, claimableIfoDataItem) => {\n    if (!campaignMap.has(claimableIfoDataItem.campaignId)) {\n      return accum\n    }\n\n    const campaignMeta = campaignMap.get(claimableIfoDataItem.campaignId)\n    const { address } = ifoCampaigns.find((ifoCampaign) => ifoCampaign.campaignId === claimableIfoDataItem.campaignId)\n\n    return [\n      ...accum,\n      {\n        address,\n        id: claimableIfoDataItem.campaignId,\n        type: 'ifo',\n        title: getAchievementTitle(campaignMeta),\n        description: getAchievementDescription(campaignMeta),\n        badge: campaignMeta.badge,\n        points: claimableIfoDataItem.numberPoints.toNumber(),\n      },\n    ]\n  }, [])\n}\n"],"mappings":"AAEA,MAAO,CAAAA,QAAQ,KAAM,sBAAsB,CAC3C,OAASC,WAAW,KAAQ,4BAA4B,CAExD,OAASC,WAAW,KAAQ,iBAAiB,CAC7C,OAASC,wBAAwB,KAAQ,sBAAsB,CAC/D,MAAO,CAAAC,iBAAiB,KAAM,gCAAgC,CAQ9D,MAAO,MAAM,CAAAC,mBAAmB,CAAIC,QAAkB,EAAuB,CAC3E,OAAQA,QAAQ,CAACC,IAAI,EACnB,IAAK,KAAK,CACR,MAAO,CACLC,GAAG,CAAE,sBAAsB,CAC3BC,IAAI,CAAE,CACJC,KAAK,CAAEJ,QAAQ,CAACI,KAClB,CACF,CAAC,CACH,QACE,MAAO,CAAAJ,QAAQ,CAACI,KAAK,CACzB,CACF,CAAC,CAED,MAAO,MAAM,CAAAC,yBAAyB,CAAIL,QAAkB,EAAuB,CACjF,OAAQA,QAAQ,CAACC,IAAI,EACnB,IAAK,KAAK,CACR,MAAO,CACLC,GAAG,CAAE,uDAAuD,CAC5DC,IAAI,CAAE,CACJC,KAAK,CAAEJ,QAAQ,CAACI,KAClB,CACF,CAAC,CACH,QACE,MAAO,CAAAJ,QAAQ,CAACM,WAAW,CAC/B,CACF,CAAC,CAED;AACA;AACA,GACA,MAAO,MAAM,CAAAC,mBAAmB,CAAG,KAAO,CAAAC,OAAe,EAA6B,CACpF,KAAM,CAAAC,YAAY,CAAGf,QAAQ,CAACgB,MAAM,CAAEC,OAAO,EAAKA,OAAO,CAACC,UAAU,GAAKC,SAAS,CAAC,CAEnF;AACA,KAAM,CAAAC,gBAAgB,CAAGL,YAAY,CAACM,GAAG,CAACC,IAAA,EAAiB,IAAhB,CAAEC,OAAQ,CAAC,CAAAD,IAAA,CACpD,MAAO,CACLC,OAAO,CAAEpB,wBAAwB,CAAC,CAAC,CACnCqB,IAAI,CAAE,kBAAkB,CACxBC,MAAM,CAAE,CAACX,OAAO,CAAES,OAAO,CAC3B,CAAC,CACH,CAAC,CAAC,CAEF,KAAM,CAAAG,aAAa,CAAI,KAAM,CAAAxB,WAAW,CAACE,iBAAiB,CAAEgB,gBAAgB,CAAE,CAAEO,cAAc,CAAE,KAAM,CAAC,CAE/F,CAER;AACA,KAAM,CAAAC,gBAAgB,CAAI,KAAM,CAAA1B,WAAW,CACzCE,iBAAiB,CACjBsB,aAAa,CAACG,MAAM,CAAC,CAACC,KAAK,CAAEC,cAAc,CAAEC,KAAK,GAAK,CACrD,GAAID,cAAc,GAAK,IAAI,CAAE,CAC3B,MAAO,CAAAD,KAAK,CACd,CAEA,KAAM,CAACG,WAAW,CAAC,CAAGF,cAAc,CAEpC,GAAIE,WAAW,GAAK,IAAI,CAAE,CACxB,MAAO,CAAC,GAAGH,KAAK,CAAE,CAAEP,OAAO,CAAEpB,wBAAwB,CAAC,CAAC,CAAEqB,IAAI,CAAE,MAAM,CAAEC,MAAM,CAAE,CAACO,KAAK,CAAE,CAAC,CAAC,CAC3F,CAEA,MAAO,CAAAF,KAAK,CACd,CAAC,CAAE,EAAE,CACP,CAAsB,CAEtB;AACA,MAAO,CAAAF,gBAAgB,CAACC,MAAM,CAAC,CAACC,KAAK,CAAEI,oBAAoB,GAAK,CAC9D,GAAI,CAACjC,WAAW,CAACkC,GAAG,CAACD,oBAAoB,CAAChB,UAAU,CAAC,CAAE,CACrD,MAAO,CAAAY,KAAK,CACd,CAEA,KAAM,CAAAM,YAAY,CAAGnC,WAAW,CAACoC,GAAG,CAACH,oBAAoB,CAAChB,UAAU,CAAC,CACrE,KAAM,CAAEK,OAAQ,CAAC,CAAGR,YAAY,CAACuB,IAAI,CAAEC,WAAW,EAAKA,WAAW,CAACrB,UAAU,GAAKgB,oBAAoB,CAAChB,UAAU,CAAC,CAElH,MAAO,CACL,GAAGY,KAAK,CACR,CACEP,OAAO,CACPiB,EAAE,CAAEN,oBAAoB,CAAChB,UAAU,CACnCX,IAAI,CAAE,KAAK,CACXG,KAAK,CAAEL,mBAAmB,CAAC+B,YAAY,CAAC,CACxCxB,WAAW,CAAED,yBAAyB,CAACyB,YAAY,CAAC,CACpDK,KAAK,CAAEL,YAAY,CAACK,KAAK,CACzBC,MAAM,CAAER,oBAAoB,CAACS,YAAY,CAACC,QAAQ,CAAC,CACrD,CAAC,CACF,CACH,CAAC,CAAE,EAAE,CAAC,CACR,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module"}