{"ast":null,"code":"import{TICKET_LIMIT_PER_REQUEST}from'config/constants/lottery';import{getLotteryV2Contract}from'utils/contractHelpers';const lotteryContract=getLotteryV2Contract();export const processRawTicketsResponse=ticketsResponse=>{const[ticketIds,ticketNumbers,ticketStatuses]=ticketsResponse;if((ticketIds===null||ticketIds===void 0?void 0:ticketIds.length)>0){return ticketIds.map((ticketId,index)=>{return{id:ticketId.toString(),number:ticketNumbers[index].toString(),status:ticketStatuses[index]};});}return[];};export const viewUserInfoForLotteryId=async(account,lotteryId,cursor,perRequestLimit)=>{try{const data=await lotteryContract.viewUserInfoForLotteryId(account,lotteryId,cursor,perRequestLimit);return processRawTicketsResponse(data);}catch(error){console.error('viewUserInfoForLotteryId',error);return null;}};export const fetchUserTicketsForOneRound=async(account,lotteryId)=>{let cursor=0;let numReturned=TICKET_LIMIT_PER_REQUEST;const ticketData=[];while(numReturned===TICKET_LIMIT_PER_REQUEST){// eslint-disable-next-line no-await-in-loop\nconst response=await viewUserInfoForLotteryId(account,lotteryId,cursor,TICKET_LIMIT_PER_REQUEST);cursor+=TICKET_LIMIT_PER_REQUEST;numReturned=response.length;ticketData.push(...response);}return ticketData;};export const fetchUserTicketsForMultipleRounds=async(idsToCheck,account)=>{const ticketsForMultipleRounds=[];for(let i=0;i<idsToCheck.length;i+=1){const roundId=idsToCheck[i];// eslint-disable-next-line no-await-in-loop\nconst ticketsForRound=await fetchUserTicketsForOneRound(account,roundId);ticketsForMultipleRounds.push({roundId,userTickets:ticketsForRound});}return ticketsForMultipleRounds;};","map":{"version":3,"names":["TICKET_LIMIT_PER_REQUEST","getLotteryV2Contract","lotteryContract","processRawTicketsResponse","ticketsResponse","ticketIds","ticketNumbers","ticketStatuses","length","map","ticketId","index","id","toString","number","status","viewUserInfoForLotteryId","account","lotteryId","cursor","perRequestLimit","data","error","console","fetchUserTicketsForOneRound","numReturned","ticketData","response","push","fetchUserTicketsForMultipleRounds","idsToCheck","ticketsForMultipleRounds","i","roundId","ticketsForRound","userTickets"],"sources":["/Users/namratapatel/upwork/SmartFinance-OmniDex/src/state/lottery/getUserTicketsData.ts"],"sourcesContent":["import { TICKET_LIMIT_PER_REQUEST } from 'config/constants/lottery'\nimport { LotteryTicket } from 'config/constants/types'\nimport { UserTicketsResponse } from 'state/types'\nimport { getLotteryV2Contract } from 'utils/contractHelpers'\n\nconst lotteryContract = getLotteryV2Contract()\n\nexport const processRawTicketsResponse = (ticketsResponse: UserTicketsResponse): LotteryTicket[] => {\n  const [ticketIds, ticketNumbers, ticketStatuses] = ticketsResponse\n\n  if (ticketIds?.length > 0) {\n    return ticketIds.map((ticketId, index) => {\n      return {\n        id: ticketId.toString(),\n        number: ticketNumbers[index].toString(),\n        status: ticketStatuses[index],\n      }\n    })\n  }\n  return []\n}\n\nexport const viewUserInfoForLotteryId = async (\n  account: string,\n  lotteryId: string,\n  cursor: number,\n  perRequestLimit: number,\n): Promise<LotteryTicket[]> => {\n  try {\n    const data = await lotteryContract.viewUserInfoForLotteryId(account, lotteryId, cursor, perRequestLimit)\n    return processRawTicketsResponse(data)\n  } catch (error) {\n    console.error('viewUserInfoForLotteryId', error)\n    return null\n  }\n}\n\nexport const fetchUserTicketsForOneRound = async (account: string, lotteryId: string): Promise<LotteryTicket[]> => {\n  let cursor = 0\n  let numReturned = TICKET_LIMIT_PER_REQUEST\n  const ticketData = []\n\n  while (numReturned === TICKET_LIMIT_PER_REQUEST) {\n    // eslint-disable-next-line no-await-in-loop\n    const response = await viewUserInfoForLotteryId(account, lotteryId, cursor, TICKET_LIMIT_PER_REQUEST)\n    cursor += TICKET_LIMIT_PER_REQUEST\n    numReturned = response.length\n    ticketData.push(...response)\n  }\n\n  return ticketData\n}\n\nexport const fetchUserTicketsForMultipleRounds = async (\n  idsToCheck: string[],\n  account: string,\n): Promise<{ roundId: string; userTickets: LotteryTicket[] }[]> => {\n  const ticketsForMultipleRounds = []\n  for (let i = 0; i < idsToCheck.length; i += 1) {\n    const roundId = idsToCheck[i]\n    // eslint-disable-next-line no-await-in-loop\n    const ticketsForRound = await fetchUserTicketsForOneRound(account, roundId)\n    ticketsForMultipleRounds.push({\n      roundId,\n      userTickets: ticketsForRound,\n    })\n  }\n  return ticketsForMultipleRounds\n}\n"],"mappings":"AAAA,OAASA,wBAAwB,KAAQ,0BAA0B,CAGnE,OAASC,oBAAoB,KAAQ,uBAAuB,CAE5D,KAAM,CAAAC,eAAe,CAAGD,oBAAoB,CAAC,CAAC,CAE9C,MAAO,MAAM,CAAAE,yBAAyB,CAAIC,eAAoC,EAAsB,CAClG,KAAM,CAACC,SAAS,CAAEC,aAAa,CAAEC,cAAc,CAAC,CAAGH,eAAe,CAElE,GAAI,CAAAC,SAAS,SAATA,SAAS,iBAATA,SAAS,CAAEG,MAAM,EAAG,CAAC,CAAE,CACzB,MAAO,CAAAH,SAAS,CAACI,GAAG,CAAC,CAACC,QAAQ,CAAEC,KAAK,GAAK,CACxC,MAAO,CACLC,EAAE,CAAEF,QAAQ,CAACG,QAAQ,CAAC,CAAC,CACvBC,MAAM,CAAER,aAAa,CAACK,KAAK,CAAC,CAACE,QAAQ,CAAC,CAAC,CACvCE,MAAM,CAAER,cAAc,CAACI,KAAK,CAC9B,CAAC,CACH,CAAC,CAAC,CACJ,CACA,MAAO,EAAE,CACX,CAAC,CAED,MAAO,MAAM,CAAAK,wBAAwB,CAAG,KAAAA,CACtCC,OAAe,CACfC,SAAiB,CACjBC,MAAc,CACdC,eAAuB,GACM,CAC7B,GAAI,CACF,KAAM,CAAAC,IAAI,CAAG,KAAM,CAAAnB,eAAe,CAACc,wBAAwB,CAACC,OAAO,CAAEC,SAAS,CAAEC,MAAM,CAAEC,eAAe,CAAC,CACxG,MAAO,CAAAjB,yBAAyB,CAACkB,IAAI,CAAC,CACxC,CAAE,MAAOC,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,0BAA0B,CAAEA,KAAK,CAAC,CAChD,MAAO,KAAI,CACb,CACF,CAAC,CAED,MAAO,MAAM,CAAAE,2BAA2B,CAAG,KAAAA,CAAOP,OAAe,CAAEC,SAAiB,GAA+B,CACjH,GAAI,CAAAC,MAAM,CAAG,CAAC,CACd,GAAI,CAAAM,WAAW,CAAGzB,wBAAwB,CAC1C,KAAM,CAAA0B,UAAU,CAAG,EAAE,CAErB,MAAOD,WAAW,GAAKzB,wBAAwB,CAAE,CAC/C;AACA,KAAM,CAAA2B,QAAQ,CAAG,KAAM,CAAAX,wBAAwB,CAACC,OAAO,CAAEC,SAAS,CAAEC,MAAM,CAAEnB,wBAAwB,CAAC,CACrGmB,MAAM,EAAInB,wBAAwB,CAClCyB,WAAW,CAAGE,QAAQ,CAACnB,MAAM,CAC7BkB,UAAU,CAACE,IAAI,CAAC,GAAGD,QAAQ,CAAC,CAC9B,CAEA,MAAO,CAAAD,UAAU,CACnB,CAAC,CAED,MAAO,MAAM,CAAAG,iCAAiC,CAAG,KAAAA,CAC/CC,UAAoB,CACpBb,OAAe,GACkD,CACjE,KAAM,CAAAc,wBAAwB,CAAG,EAAE,CACnC,IAAK,GAAI,CAAAC,CAAC,CAAG,CAAC,CAAEA,CAAC,CAAGF,UAAU,CAACtB,MAAM,CAAEwB,CAAC,EAAI,CAAC,CAAE,CAC7C,KAAM,CAAAC,OAAO,CAAGH,UAAU,CAACE,CAAC,CAAC,CAC7B;AACA,KAAM,CAAAE,eAAe,CAAG,KAAM,CAAAV,2BAA2B,CAACP,OAAO,CAAEgB,OAAO,CAAC,CAC3EF,wBAAwB,CAACH,IAAI,CAAC,CAC5BK,OAAO,CACPE,WAAW,CAAED,eACf,CAAC,CAAC,CACJ,CACA,MAAO,CAAAH,wBAAwB,CACjC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module"}